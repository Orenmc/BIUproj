<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>Botalks IVR Builder</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd"
    crossorigin="anonymous">
  <link href="jquery.flowchart.css" rel="stylesheet" type="text/css">
  <style>
    body {
      background-color: #fafafa;
    }

    .container {
      margin: 150px auto;
    }

    .demo {
      background-color: bisque;
      border-color: black;
      height: 500px;
      width: 800px;
      margin-bottom: 10px;
      position: absolute;

    }
    .visible{
      visibility: hidden;
    }
    .column {
      float:left;
      width: 33.33%;
      padding: 20px;
      height: 300px;
    }

  </style>
  <h1>Botalks IVR Builder</h1>

</head>


<body>

  <div class="column" style="margin-right: 10px; width: 20%">
    <div class="btn-group-vertical" role="group" style="border-style: solid;
      border-color:black; padding: 2px">
      <button type="button" class="button btn btn-primary" id="create_msg_1_2">Add MSG 1_2</button>
      <button type="button" class="button btn btn-primary" id="create_msg_1_1">Add MSG 1_1</button>
      <button type="button" class="button btn btn-primary" id="create_END">Add END</button>
      <button type="button" class="button btn btn-danger" id="delete_selected_button">Delete Selected Operator</button>
      <button type="button" class="button btn btn-success" id="print_button">print IVR</button>
    </div>
    <div id="operator_properties" style="display: none;border-style: solid;
      border-color:black; padding: 10px; margin-top: 2px">
      <label for="operator_title">Operator's Title:</label>
      <input type="text" id="operator_title">
    </div>
    <div id="link_properties" style="display: none;border-style: solid;
      border-color:black; padding: 10px; margin-top: 2px">
      <label for="link_color">Link's Color:</label>
      <input type="color" id="link_color">
    </div>
  </div>

  <div class="column" style="width: 67.66%;">
    <div class="demo" id="ivr" style="border-style: solid;
      border-color:black;"></div>
  </div>

  <script src="http://code.jquery.com/jquery-1.12.2.min.js"></script>
  <script src="http://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
  <script src="jquery.flowchart.js"></script>

  <script>
    $(document).ready(function () {

      var data = {
        operators: {
          Start: {
            top: 10,
            left: 10,
            properties: {
              title: 'Start',
              inputs: {},
              outputs: {
                output_1: {
                  label: 'Hello MSG',
                }
              }
            }
          }
        }
      };

      var $operatorProperties = $('#operator_properties');
      var $linkProperties = $('#link_properties');
      var $operatorTitle = $('#operator_title');
      var $linkColor = $('#link_color');

      // Apply the plugin on a standard, empty div...
      $('#ivr').flowchart({
        data: data,
        onOperatorSelect: function (operatorId) {
          $("#operator_properties").css('display','block');
          $operatorTitle.val($('#ivr').flowchart('getOperatorTitle', operatorId));
          return true;
        },
        onOperatorUnselect: function () {
          $("#operator_properties").css('display','none');
          return true;
        },
        onLinkSelect: function (linkId) {
          $linkProperties.show();
          $("#link_properties").css('display','block');
          $linkColor.val($('#ivr').flowchart('getLinkMainColor', linkId));
          return true;
        },
        onLinkUnselect: function () {
          $("#link_properties").css('display','none');
          return true;
        }
      });
      $operatorTitle.keyup(function () {
        var selectedOperatorId = $('#ivr').flowchart('getSelectedOperatorId');
        if (selectedOperatorId != null) {
          $('#ivr').flowchart('setOperatorTitle', selectedOperatorId, $operatorTitle.val());
        }
      });

      $linkColor.change(function () {
        var selectedLinkId = $('#ivr').flowchart('getSelectedLinkId');
        if (selectedLinkId != null) {
          $('#ivr').flowchart('setLinkMainColor', selectedLinkId, $linkColor.val());
        }
      });
    });


    $('#create_msg_1_2').click(function () {
      var operatorI = $('#ivr').flowchart('getOperatorNum');
      var operatorId = 'created_operator_' + operatorI;
      var operatorData = {
        top: 80,
        left: 500,
        properties: {
          title: 'Messege ' + (operatorI),
          inputs: {
            input_1: {
              label: 'MSG',
            }
          },
          outputs: {
            output_1: {
              label: 'digit 1',
            },
            output_2: {
              label: 'digit 2',
            }
          }
        }
      };
      $('#ivr').flowchart('createOperator', operatorId, operatorData);
    });

    $('#create_msg_1_1').click(function () {
      var operatorI = $('#ivr').flowchart('getOperatorNum');
      var operatorId = 'created_operator_' + operatorI;
      var operatorData = {
        top: 80,
        left: 500,
        properties: {
          title: 'Messege ' + (operatorI),
          inputs: {
            input_1: {
              label: 'digit',
            }
          },
          outputs: {
            output_1: {
              label: 'play msg',
            }
          }
        }
      };
      $('#ivr').flowchart('createOperator', operatorId, operatorData);
    });


    $('#create_END').click(function () {
      var operatorI = $('#ivr').flowchart('getEndNum');
      var operatorId = 'created_end_' + operatorI;
      var operatorData = {
        top: 80,
        left: 500,
        properties: {
          title: 'END',
          inputs: {
            input_1: {
              label: 'End call',
            }
          },
          outputs: {}
        }
      };
      $('#ivr').flowchart('createOperator', operatorId, operatorData);
    });

    $('#delete_selected_button').click(function () {
      $('#ivr').flowchart('deleteSelected');
    });

    $('#print_button').click(function () {

      $('#ivr').flowchart('printIVR');
    });
  </script>

</body>

</html>